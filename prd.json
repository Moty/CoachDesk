{
  "project": "HelpDesk",
  "branchName": "ralph/self-serve-registration",
  "description": "Self-serve registration flow with backend endpoint, UI signup, default organization handling, and admin seed script.",
  "userStories": [
    {
      "id": "US-001",
      "title": "Default organization config for registration",
      "description": "As a system owner, I want new users assigned to a default organization so tenancy rules keep working.",
      "acceptanceCriteria": [
        "Add required DEFAULT_ORGANIZATION_ID env config used by registration",
        "Registration fails with clear error when DEFAULT_ORGANIZATION_ID is missing",
        "Typecheck passes"
      ],
      "priority": 1,
      "blockedBy": [],
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-002",
      "title": "Public registration endpoint",
      "description": "As a new user, I want to register so I can access the system without admin creation.",
      "acceptanceCriteria": [
        "Add POST /api/v1/auth/register accepting email, password, displayName",
        "Creates Firebase Auth user and sets custom claims role and organizationId",
        "Creates Firestore users document with id, email, displayName, role, organizationId",
        "Default role is customer for self-service registration",
        "Responds with sanitized user payload without password",
        "Typecheck passes",
        "Tests pass"
      ],
      "priority": 2,
      "blockedBy": [
        "US-001"
      ],
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-003",
      "title": "Registration UI flow",
      "description": "As a new user, I want a registration form so I can create an account from the login screen.",
      "acceptanceCriteria": [
        "Add /register route or login toggle with email, display name, and password fields",
        "Client validates required fields and password length >= 8",
        "On success, user is signed in and redirected to /",
        "API errors (email exists, validation, rate limit) display in UI",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "blockedBy": [
        "US-002"
      ],
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-004",
      "title": "Seed initial admin user",
      "description": "As a developer, I want an initial admin user so I can access admin features on a fresh environment.",
      "acceptanceCriteria": [
        "Add idempotent seed script creating Firebase Auth user moty.moshin@gmail.com with password 12345678",
        "Script sets custom claims role=admin and organizationId=DEFAULT_ORGANIZATION_ID",
        "Script creates Firestore users document if missing",
        "Script is safe to re-run without duplicates",
        "Document how to run the seed script",
        "Typecheck passes"
      ],
      "priority": 4,
      "blockedBy": [
        "US-002"
      ],
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-005",
      "title": "Typed API client and error handling",
      "description": "As a developer, I want a consistent API client so UI calls match existing endpoints.",
      "acceptanceCriteria": [
        "Create API client using VITE_API_BASE_URL",
        "Attach Authorization: Bearer <token> from AuthProvider to requests",
        "Handle backend error format { code, message, details } with user-friendly messages",
        "Support pagination and filtering query params",
        "Support multipart/form-data file upload with field name file",
        "Tests pass",
        "Typecheck passes"
      ],
      "priority": 5,
      "blockedBy": [
        "US-003"
      ],
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-006",
      "title": "Role-based routing and access denied state",
      "description": "As a user, I want role-based access so I only see pages I can use.",
      "acceptanceCriteria": [
        "Fetch current user via GET /api/v1/users/me on app load",
        "Store user role (customer/agent/admin) in auth state",
        "Gate routes by role and show access denied state when unauthorized",
        "Verify in browser using dev-browser skill",
        "Typecheck passes"
      ],
      "priority": 6,
      "blockedBy": [
        "US-004",
        "US-005"
      ],
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-007",
      "title": "Ticket list page with pagination",
      "description": "As a user, I want to view tickets so I can manage workload.",
      "acceptanceCriteria": [
        "Create Tickets page that calls GET /api/v1/tickets with pagination",
        "Render ticket rows with subject, status, priority, requester, and updatedAt",
        "Show empty-state message when no tickets match",
        "Verify in browser using dev-browser skill",
        "Typecheck passes"
      ],
      "priority": 7,
      "blockedBy": [
        "US-006"
      ],
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-008",
      "title": "Ticket list filters and sorting",
      "description": "As a user, I want to filter and sort tickets so I can find work quickly.",
      "acceptanceCriteria": [
        "Add filters for status, priority, assignee, and tags",
        "Add sorting for createdAt, updatedAt, and priority",
        "Filters and sorting update API query params",
        "Verify in browser using dev-browser skill",
        "Typecheck passes"
      ],
      "priority": 8,
      "blockedBy": [
        "US-007"
      ],
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-009",
      "title": "Ticket detail page",
      "description": "As a user, I want to view ticket details so I can understand the request.",
      "acceptanceCriteria": [
        "Create Ticket Detail page that loads GET /api/v1/tickets/:id",
        "Display ticket metadata (status, priority, assignee, requester, tags, SLA timers)",
        "Show not-found state when ticket does not exist",
        "Verify in browser using dev-browser skill",
        "Typecheck passes"
      ],
      "priority": 9,
      "blockedBy": [
        "US-006"
      ],
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-010",
      "title": "Ticket comments timeline",
      "description": "As a user, I want to read ticket comments so I can follow the conversation.",
      "acceptanceCriteria": [
        "Load comments via GET /api/v1/tickets/:id/comments with pagination",
        "Render comments timeline with author, timestamp, and visibility label",
        "Hide internal comments from customers",
        "Verify in browser using dev-browser skill",
        "Typecheck passes"
      ],
      "priority": 10,
      "blockedBy": [
        "US-009"
      ],
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-011",
      "title": "Comment composer",
      "description": "As a user, I want to add comments so communication is tracked.",
      "acceptanceCriteria": [
        "Add comment composer that posts to POST /api/v1/tickets/:id/comments",
        "Allow agents/admins to choose public vs internal; customers always public",
        "Append new comment to timeline without full page refresh",
        "Verify in browser using dev-browser skill",
        "Typecheck passes"
      ],
      "priority": 11,
      "blockedBy": [
        "US-010"
      ],
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-012",
      "title": "Create ticket page",
      "description": "As a user, I want to create tickets so I can request support.",
      "acceptanceCriteria": [
        "Create ticket form that posts to POST /api/v1/tickets",
        "Validate subject (1-255 chars) and description (1+ chars) before submit",
        "Support priority and tags inputs",
        "Navigate to new ticket detail on success",
        "Verify in browser using dev-browser skill",
        "Typecheck passes"
      ],
      "priority": 12,
      "blockedBy": [
        "US-006"
      ],
      "passes": true,
      "notes": ""
    },
    {
      "id": "US-013",
      "title": "Agent/admin ticket updates",
      "description": "As an agent/admin, I want to update ticket fields so I can manage tickets.",
      "acceptanceCriteria": [
        "Add status/priority/tags update controls using PATCH /api/v1/tickets/:id",
        "Add assignee picker using PATCH /api/v1/tickets/:id/assign",
        "Prevent invalid status transitions per backend rules",
        "Verify in browser using dev-browser skill",
        "Typecheck passes"
      ],
      "priority": 13,
      "blockedBy": [
        "US-009"
      ],
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-014",
      "title": "Attachment uploader",
      "description": "As a user, I want to upload attachments so I can share files with support.",
      "acceptanceCriteria": [
        "Add attachment uploader that posts to POST /api/v1/tickets/:id/attachments with file field",
        "Enforce 10MB file size limit before upload",
        "Show uploaded attachments in ticket timeline with download links",
        "Verify in browser using dev-browser skill",
        "Typecheck passes"
      ],
      "priority": 14,
      "blockedBy": [
        "US-009"
      ],
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-015",
      "title": "Admin user management",
      "description": "As an admin, I want to manage users so I can onboard agents and customers.",
      "acceptanceCriteria": [
        "Create Admin Users page listing users via GET /api/v1/users with role filter",
        "Add user creation form posting to POST /api/v1/users",
        "Surface API validation errors for email and role",
        "Verify in browser using dev-browser skill",
        "Typecheck passes"
      ],
      "priority": 15,
      "blockedBy": [
        "US-006"
      ],
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-016",
      "title": "Admin SLA rules list and create",
      "description": "As an admin, I want to list and create SLA rules so I can manage policies.",
      "acceptanceCriteria": [
        "Create Admin SLA Rules page listing rules via GET /api/v1/admin/sla-rules",
        "Add create SLA rule form posting to POST /api/v1/admin/sla-rules",
        "Show success and error feedback from API",
        "Verify in browser using dev-browser skill",
        "Typecheck passes"
      ],
      "priority": 16,
      "blockedBy": [
        "US-006"
      ],
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-017",
      "title": "Admin SLA rules edit and delete",
      "description": "As an admin, I want to update and remove SLA rules so policies stay current.",
      "acceptanceCriteria": [
        "Add edit and delete actions for SLA rules using PATCH/DELETE /api/v1/admin/sla-rules/:id",
        "Update list after edits/deletes without full page refresh",
        "Verify in browser using dev-browser skill",
        "Typecheck passes"
      ],
      "priority": 17,
      "blockedBy": [
        "US-016"
      ],
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-018",
      "title": "Admin audit logs",
      "description": "As an admin, I want to view audit logs so I can review actions.",
      "acceptanceCriteria": [
        "Create Admin Audit Logs page listing GET /api/v1/admin/audit-logs",
        "Add filters for date range, user, and action (if supported by API)",
        "Render empty state when no logs match",
        "Verify in browser using dev-browser skill",
        "Typecheck passes"
      ],
      "priority": 18,
      "blockedBy": [
        "US-006"
      ],
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-019",
      "title": "Hosting and deployment integration",
      "description": "As a developer, I want frontend hosting configured so the UI is available in production.",
      "acceptanceCriteria": [
        "Update firebase.json to serve the SPA from web/dist",
        "Proxy /api/** requests to the existing backend service",
        "Update .env.example CORS_ORIGIN to include frontend dev and prod domains",
        "Document frontend setup/run in README.md",
        "Update docs/deployment/firebase-deployment.md with frontend build/deploy steps",
        "Tests pass",
        "Typecheck passes"
      ],
      "priority": 19,
      "blockedBy": [
        "US-001"
      ],
      "passes": false,
      "notes": ""
    }
  ]
}
